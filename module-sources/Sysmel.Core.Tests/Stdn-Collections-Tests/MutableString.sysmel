namespace Stdn definition: {
namespace Collections definition: {
namespace Tests definition: {

template MutableBasicStringTestCase(StringClass: Type)
 := class superclass: Stdn Testing TestCase; definition: {
    test: testEmptyString with: {
        let string type: StringClass.
        self assert: string size equals: 0.
        self assert: string isEmpty.
        self deny: string isNotEmpty.
    }.

    test: testFromLiteral with: {
        let string := StringClass fromLiteral: "Hello World".

        self assert: string isNotEmpty.
        self deny: string isEmpty.
        self assert: string size equals: 11.
        self assert: string first equals: 'H'.
        self assert: string second equals: 'e'.
        self assert: string third equals: 'l'.
        self assert: string fourth equals: 'l'.
        self assert: string fifth equals: 'o'.
        self assert: string sixth equals: ' '.
        self assert: string seventh equals: 'W'.
        self assert: string eighth equals: 'o'.
        self assert: string ninth equals: 'r'.
        self assert: string tenth equals: 'l'.
        self assert: string[10] equals: 'd'.

    }.

    test: testConcat with: {
        self assert: (StringClass fromLiteral: "ab") -- StringClass newValue equals: (StringClass fromLiteral: "ab").
        self assert: StringClass newValue -- (StringClass fromLiteral: "ab") equals: (StringClass fromLiteral: "ab").

        self assert: (StringClass fromLiteral: "ab") -- (StringClass fromLiteral: "cd") equals: (StringClass fromLiteral: "abcd").
        self assert: ((StringClass fromLiteral: "ab") -- (StringClass fromLiteral: "cd")) size equals: 4.
    }.

    test: testCopyFromLast with: {
        self assert: ((StringClass fromLiteral: "test.txt") copyFromLast: '.') equals: (StringClass fromLiteral: ".txt").
    }.

    test: testCopyAfterLast with: {
        self assert: ((StringClass fromLiteral: "test.txt") copyAfterLast: '.') equals: (StringClass fromLiteral: "txt").
    }.

    test: testCopyUpToLast with: {
        self assert: ((StringClass fromLiteral: "test.txt") copyUpToLast: '.') equals: (StringClass fromLiteral: "test").
    }.

}.

compileTime constant MutableStringTestCase := MutableBasicStringTestCase(String).
compileTime constant MutableWStringTestCase := MutableBasicStringTestCase(WString).
compileTime constant MutableLStringTestCase := MutableBasicStringTestCase(LString).

}. ## namespace Tests
}. ## namespace Collections
}. ## namespace Stdn
